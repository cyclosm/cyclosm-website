const banana = new Banana()

window.addEventListener('load', () => {
    let userLang = navigator.language || navigator.userLanguage;
    banana.setLocale('en')
    if (userLang.startsWith("fr")) {
        banana.setLocale('fr')
    }
    messages = {}
    if (banana.locale == "fr") {
        messages = {
            "legend": "Légende",
            "bike-infra": "Infrastructure cycliste",
            "separate-cycleway": "Piste cyclable séparée",
            "path-bikes": "Piste prévue pour les vélos",
            "cycle-track": "Piste cyclable de ce côté de la route",
            "cycle-lane": "Voie cyclable de ce côté de la route",
            "shared-lane": "Voie partagée (avec les bus ou autres véhicules à moteur) de ce côté de la route",
            "road-shoulder": "Accotement ouvert aux vélos",
            "double-way-bikes": "Rue à double sens pour les vélos (sens unique pour les voitures)",
            "bike-road": "Route prévue pour les bicyclettes",
            "steps-bike": "Escalier avec une rampe adaptée aux vélos",
            "cycle-streets": "Rue cyclable",
            "highway-infra": "Type de routes",
            "motorway-default": "Autoroute, voie rapide ou express (par défaut)",
            "motorway-explicit": "Autoroute, voie rapide ou express (vélo explicitement autorisé)",
            "primary": "Route majeure",
            "secondary": "Route secondaire",
            "tertiary": "Route tertiaire",
            "standard": "Standard",
            "living-street": "Zone de rencontre",
            "pedestrian": "Rue piétonne",
            "30-km": "30 km/h",
            "20-km": "20 km/h",
            "no-motor": "Accès interdit aux véhicules à moteur",
            "bike-not-allowed": "Vélo non autorisé",
            "track": "Piste",
            "path": "Chemin non carrossable",
            "footway": "Voie piétonne",
            "bridleway": "Chemin pour cavaliers",
            "bad-surface": "Mauvais revêtement (bon pour cyclocross/trekking/vélos gravel)",
            "very-bad-surface": "Surface très mauvaise (bon pour les VTT)",
            "unknown-quality": "Qualité de surface inconnue",
            "MTB": "V T T",
            "STS-0": "difficulté 0 (single trail scale) très facile",
            "STS-1": "difficulté 1 (single trail scale) facile",
            "STS-2": "difficulté 2(single trail scale) moyenne",
            "STS-3": "difficulté 3 (single trail scale) difficile",
            "STS-4": "difficulté 4 (single trail scale) très difficile",
            "STS-5": "difficulté 5 (single trail scale) extrêmement difficile",
            "IMBA-easiest": "difficulté IMBA très facile (cercle blanc)",
            "IMBA-easy": "difficulté IMBA facile (cercle vert)",
            "IMBA-more-difficult": "difficulté IMBA difficile (carré bleu)",
            "IMBA-very-difficult": "difficulté IMBA très difficile  (losange noir)",
            "IMBA-x-difficult": "difficulté IMBA extrêmement difficile (double losange noir)",
            "bike-routes": "Itinéraires cyclables",
            "inter-bike-route": "Itinéraire cyclable international",
            "national-bike-route": "Itinéraire cyclable national",
            "regional-bike-route": "Itinéraire cyclable régional",
            "local-bike-route": "Itinéraire cyclable local",
            "MTB-route": "Itinéraire VTT",
            "num-cycle-junction": "Jonction de piste numérotée",
            "bike-amenities": "Aménagements pour cycles",
            "bike-repair-station": "Station de réparation de vélo",
            "compressed-air": "Air comprimé",
            "bike-parking": "Parking à vélos",
            "bike/motorcycle-parking": "Parking partagé pour vélos/motos",
            "covered-bike-parking": "Parking à vélos couvert et protégé",
            "floor-bike-parking": "Parking à vélos sans point fixe",
            "bike-rental": "Location de bicyclettes",
            "bike-shop": "Boutique de bicyclettes",
            "Inner-tube-shop": "Distributeur de chambres à air",
            "bike-counter": "Compteur de vélos",
            "first-aid": "Premiers secours",
            "hospital": "Hôpital",
            "police": "Police",
            "pharmacy": "Pharmacie",
            "drinking-water": "Eau potable",
            "toilets": "Toilettes",
            "shelter": "Abri",
            "emergency-phone": "Téléphone d'urgence",
            "public-bath": "Bain public",
            "shower": "Douche",
            "shops": "Magasins",
            "supermarket": "Supermarché",
            "convenience-shop": "Commerce de proximité",
            "post-office": "Bureau de poste",
            "bar": "Bar",
            "café": "Café",
            "internet-cafe": "Café Internet",
            "fast-food": "Restauration rapide",
            "pub": "Pub",
            "restaurant": "Restaurant",
            "art": "Marchand dart",
            "bakery": "Boulangerie",
            "biergarten": "Brasserie",
            "beverages": "Buvette",
            "confectionery": "Confiseur",
            "green-grocer": "Primeur",
            "ice-cream": "Distributeur de glaces",
            "Post-box": "Boîte aux lettres",
            "housing": "Logements",
            "apartment": "Appartement",
            "camping": "Camping",
            "caravan-park": "Aire de camping-car",
            "chalet": "Chalet",
            "guest-house": "Maison d'hôtes",
            "hostel": "Auberge",
            "hotel": "Hôtel",
            "motel": "Motel",
            "natural": "Sites naturels",
            "cave": "Grotte",
            "peak": "Pic",
            "saddle": "Col",
            "spring": "Source",
            "waterfall": "Chute d'eau",
            "tree": "Arbre",
            "tourism": "Tourisme",
            "arch-site": "Site archéologique",
            "bench": "Banc",
            "castle": "Château",
            "fort": "Fort",
            "fortress": "Forteresse",
            "information": "Information",
            "manor": "Manoir",
            "museum": "Musée",
            "monument": "Monument",
            "office": "Bureau",
            "palace": "Palais",
            "picnic": "Aire de pique-nique",
            "viewpoint": "Point de vue",
            "artwork": "uvre d'art",
            "audioguide": "Audioguide",
            "board": "Panneau d'information",
            "bust": "Buste",
            "city-gate": "Porte de la ville",
            "guidepost": "Panneau d'orientation",
            "map": "Carte",
            "memorial": "Mémorial",
            "obelisk": "Obélisque",
            "plaque": "Plaque",
            "shrine": "Sanctuaire",
            "statue": "Statue",
            "stone": "Pierre",
            "terminal": "Terminal",
            "misc": "Divers",
            "trafic-light": "Feux de signalisation",
            "trafic-calming": "Dispositif pour réduire la vitesse",
            "bike-zebra": "Passage zèbré pour bicyclettes",
            "ford": "Gué",
            "elevator": "Ascenseur (bleu si adapté aux vélos)",
            "train-station": "Gare ferroviaire",
            "aerodrome": "Aérodrome",
            "helipad": "Héliport",
            "bunker": "Bunker",
            "chimney": "Cheminée (p.ex. usine)",
            "crane": "Grue",
            "cross": "Croix",
            "fountain": "Fontaine",
            "light-house": "Phare",
            "storage-tank": "Réservoir de stockage",
            "water-tower": "Château d'eau",
            "wind-plant": "Centrale éolienne",
            "wind-mill": "Moulin à vent",
            "barriers": "Barrières",
            "cattle-grid": "Grille pour bétail",
            "cycle-barrier": "Barrière ralentissant ou interdisant les vélos",
            "gate": "Portail",
            "kissing-gate": "Portillon à chicanes",
            "lift-gate": "Barrière levante",
            "stile": "Échalier",
            "blocks": "Borne, bloc, muret de sécurité"
        }
    }
    banana.load(messages, banana.locale)
    document.querySelectorAll('.i18n').forEach(element => {
        let message = element.dataset.i18n
        if (message === undefined) {
            return
        }
        let localizedMessage = banana.i18n(message)
        if (message !== undefined && message != localizedMessage) {
            element.innerText = banana.i18n(message)
        }
    })
})
